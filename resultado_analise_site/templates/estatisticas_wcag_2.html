{% extends "cabecalho.html" %}

{% load resultado_analise_site %}

{% block title %}
    TCC MBA USP/ESALQ - Análise de site
{% endblock %}

{% block content %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
    </script>

    <h3>Estatísticas dos resultados</h3>
    <br>
    <b>Número total de violações:</b> {{ numero_total_violacoes }}
    <br>
    <br>

    <div class="row">
        <div class="column" style="padding: 5px;">
            <b>Associação entre violações</b>
            <br>
            <br>
            <table style="table-layout: fixed;">
                <tr style="padding: 5px;" class="first_tr">
                    <th style=" border-bottom: 1px;"></th>
                    {% for col in tabela.columns %}
                        <th style="padding: 5px;">
                            <b>{{ col }}</b>
                        </th>
                    {% endfor %}
                </tr>
                {% for index, row in tabela.iterrows %}
                    <tr style="padding: 5px;">
                        <th align="left" style="padding: 5px;" class="first_tr">
                            {{ index }}
                        </th>
                        {% for cell in row %}
                            {% if cell >= 0 %}
                                {% for i in cores_index %}
                                    {% if i == cell %}
                                        <th align="left" style="padding: 5px; background-color: {{ cores|lookup:i }};">
                                            {{ cell }}
                                        </th>
                                    {% endif %}
                                {% endfor %}
                            {% else %}
                                <th style="padding: 5px;"></th>
                            {% endif %}
                        {% endfor %}
                    </tr>
                {% endfor %}
              </table>
            <br><br><br>
            ------------------------------
            <br><br><br>

            <canvas id="myChart" style="width:100%;max-width:700px"></canvas>
            <script>
                // const xValues = ["Italy", "France", "Spain", "USA", "Argentina"];
                // const yValues = [55, 49, 44, 24, 15];
                const xValues = {{ eixo_x }};
                const yValues = {{ tabela_histograma }};
                //const barColors = {{ cores_barras }};//["red", "green","blue","orange","brown"];

                new Chart("myChart", {
                    type: "bar",
                    data: {
                        labels: xValues,
                        datasets: [{
                        //backgroundColor: barColors,
                        data: yValues
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                        yAxes: [{
                            ticks: {
                            beginAtZero: true
                            }
                        }]
                        },

                        title: {
                        display: true,
                        text: "Quantas vezes cada número aparece na tabela acima?"
                        }
                    }
                });
            </script>
        </div>
    </div>

{% endblock %}